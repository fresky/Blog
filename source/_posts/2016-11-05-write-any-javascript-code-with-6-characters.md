title: 用6个字符写出任意的Javascript代码
date: 2016-11-05 10:04:54
categories:
tags: Javascript
description:
---
[A Javascript journey with only six characters](http://jazcash.com/a-javascript-journey-with-only-six-characters/)展示了只用`(`，`)`，`+`，`[`，`]`和`!`这6个字符能做什么事情。[JSFuck](http://www.jsfuck.com/)是一个网站，把你输入的任何Javascript语句翻译成只用这6个字符表示的形式，比如`alert(1)`可以用如下的6个字符代码替代，是不是大开眼界:)。

```javascript
(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]
```

下面简单说一下这个原理。首先，下面的是Javascript的规则：
1. `!`开头会被转换成布尔值
1. `+`开头会被转换成数值
1. `[]`开头会被转换成字符串

也就是说如下的这些语句都是true。

```javascript
![] === false
+[] === 0
[]+[] === ""
```

这样我们就能做一些有意思的事情了，比如如下的代码：

```javascript
![]+[] === "false"
+!![] === 1
------------------------
(![]+[])[+!![]] === "a"  // same as "false"[1]
```

这样我们其实就能从`(`，`)`，`+`，`[`，`]`和`!`这6个字符中得到如下的字符了：`true`，`false`，`a`，`e`，`f`，`l`，`r`，`s`，`t`，`u`。

我们还能用如下的方式拿到"undefined"。

```javascript
[][[]] + [] === "undefined"
```

另外`Number`类型的`toString`方法有一个可以取底数的功能，如下所示，这样我们就能拿到`0-9`和`a-z`的所有字符了。如下所示：

```javascript
(12)["toString"](10) === "12" // base 10 - normal to us
(12)["toString"](2) === "1100" // base 2, or binary, for 12
(12)["toString"](8) === "14" // base 8 (octonary) for 12
(12)["toString"](16) === "c" // hex for 12
(10)["toString"](36) === "a"
(35)["toString"](36) === "z"
```

那么我们如何拼凑一个函数呢？
```javascript
[]["fill"]["constructor"] === Function
```

而`Function("alert(1)")`能返回给我们如下的函数
```javascript
function anonymous() {
    alert(1)
}
```

也就是说如果我写下面的语句，那么就会在浏览器中弹出一个对话框来。
```javascript
[]["fill"]["constructor"]("alert(1)")()
```

而这条语句中的所有字符都能用`(`，`)`，`+`，`[`，`]`和`!`这6个字符表示出来，这样大家就理解了那个[JSFuck](http://www.jsfuck.com/)网站是如何工作的了吧。